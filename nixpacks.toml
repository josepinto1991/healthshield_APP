[phases.setup]
cmds = [
  "echo '=== INICIANDO BUILD ==='",
  "pwd",
  "ls -la"
]

# AÑADIR estas dependencias CRÍTICAS
[phases.setup.deps]
debian-packages = [
  "python3-pip",      # ← ESTO FALTA
  "python3-venv",
  "libpq-dev",
  "gcc",
  "python3-dev"
]

[phases.install]
cmds = [
  "BACKEND_DIR=$(find . -type f -name 'requirements.txt' -exec dirname {} \\; | head -1)",
  "echo 'Backend encontrado en: $BACKEND_DIR'",
  "cd \"$BACKEND_DIR\"",
  "echo 'Instalando dependencias en:'",
  "pwd",
  "ls -la",
  "pip3 install -r requirements.txt || pip install -r requirements.txt"  # ← Usar pip3
]

[start]
cmd = "BACKEND_DIR=$(find /app -type f -name 'requirements.txt' -exec dirname {} \\; | head -1) && cd \"$BACKEND_DIR\" && gunicorn main:app --workers 1 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0:$PORT"